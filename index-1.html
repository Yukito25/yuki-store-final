<!DOCTYPE html>
<html lang="vi" data-theme="system">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yuki Store — Dịch vụ số • Chuẩn từng bit</title>

  <!-- SEO -->
  <meta name="description" content="Yuki Store — Dịch vụ số chính chủ. Nhanh, chuẩn, chuyên nghiệp. Đặt là chạy, đối soát tự động, xác nhận qua email.">
  <meta property="og:image" content="yuki-logo.png">
  <meta name="theme-color" content="#4f46e5">
  <link rel="icon" href="yuki-logo.png">
  <meta name="color-scheme" content="light dark">

  <!-- CSP -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    img-src 'self' data: blob: https://img.vietqr.io https://cdn.pixabay.com;
    script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net;
    style-src 'self' 'unsafe-inline';
    connect-src 'self' https://api.emailjs.com;
  ">

  <!-- Tailwind + EmailJS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

  <style>
    :root { color-scheme: light dark; }
    html[data-theme="dark"] body{ background:#0b0f24;color:#e9e7ff }
    body{font-family:Inter,system-ui,sans-serif;}

    .btn{background:linear-gradient(135deg,#6d28d9,#22d3ee);color:#fff;border-radius:12px;padding:10px 14px;font-weight:600;transition:.25s}
    .btn:hover{filter:brightness(1.07);transform:translateY(-1px)}
    .btn-outline{border:1px solid rgba(99,102,241,.35);border-radius:10px;padding:8px 12px}
    .btn-outline:hover{background:rgba(99,102,241,.08)}
    .card{background:#fff;border:1px solid #ececf5;border-radius:16px;padding:1rem;box-shadow:0 3px 10px rgba(30,41,59,.06)}
    html[data-theme="dark"] .card{background:#151739;border-color:#2a3072;box-shadow:0 0 14px rgba(99,102,241,.12)}
    .input{background:#f9f9ff;border:1px solid #e2e8f0;border-radius:10px;padding:10px 12px;width:100%;transition:.2s}
    .input:focus{border-color:#6366f1;outline:none;box-shadow:0 0 0 3px rgba(99,102,241,0.2)}
    html[data-theme="dark"] .input{background:#14163d;border-color:#303374;color:#e9e7ff}
    .chip{padding:6px 10px;border-radius:999px;border:1px solid rgba(99,102,241,.25);font-size:12px}
    .chip.active{background:linear-gradient(135deg,#6d28d9,#22d3ee);color:#fff;border-color:transparent}
    .drawer{transform:translateX(100%);transition:transform .28s ease}
    .drawer.open{transform:translateX(0)}
    .modal{display:none}
    .modal.show{display:flex;animation:fadeIn .18s ease}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    .hdr{background:linear-gradient(180deg,rgba(255,255,255,.8),rgba(255,255,255,.6));backdrop-filter:blur(10px)}
    html[data-theme="dark"] .hdr{background:linear-gradient(180deg,rgba(11,15,36,.7),rgba(11,15,36,.5))}
    .gradtxt{background:linear-gradient(135deg,#93c5fd,#c084fc,#22d3ee);-webkit-background-clip:text;background-clip:text;color:transparent}
  </style>
</head>

<body class="text-gray-900 dark:text-indigo-100 selection:bg-indigo-500/40">
  <header class="hdr border-b border-indigo-100 dark:border-[#242659] p-3 flex items-center justify-between sticky top-0 z-40">
    <div class="flex items-center gap-3">
      <img src="yuki-logo.png" onerror="this.replaceWith(Object.assign(document.createElement('div'),{className:'text-2xl font-extrabold gradtxt',innerText:'Yuki Store'}))" alt="Yuki Store" class="w-9 h-9 rounded-md">
      <span class="hidden md:inline text-xl font-bold gradtxt">Yuki Store</span>
    </div>
    <div class="flex items-center gap-2">
      <div class="flex rounded-lg overflow-hidden border border-indigo-200 dark:border-[#2c2f74]">
        <button id="langVI" class="px-2.5 py-1 text-sm hover:bg-indigo-50 dark:hover:bg-white/10">🇻🇳</button>
        <button id="langEN" class="px-2.5 py-1 text-sm hover:bg-indigo-50 dark:hover:bg-white/10">🇬🇧</button>
      </div>
      <button id="themeToggle" class="btn-outline text-sm" title="Toggle theme">🌓</button>
      <button id="openCart" class="btn text-sm md:text-base">🛒 <span data-t="cart">Giỏ hàng</span> <span id="cartCount" class="ml-1">(0)</span></button>
    </div>
  </header>

  <section class="text-center py-14 px-6 bg-gradient-to-b from-indigo-50 via-white to-transparent dark:from-[#0f1130] dark:via-[#0b0f24] dark:to-transparent">
    <h1 class="text-3xl md:text-5xl font-extrabold mb-3 gradtxt" data-t="hero_title">Dịch vụ số chính chủ — nhanh, chuẩn, không drama.</h1>
    <p class="text-gray-600 dark:text-indigo-200 max-w-3xl mx-auto leading-relaxed" data-t="hero_desc">
      Đặt hàng nhanh. Thanh toán an toàn. Xác nhận tự động qua email.
    </p>
    <div class="mt-6 flex items-center justify-center gap-3">
      <button id="cta" class="btn" data-t="hero_cta">Khám phá ngay</button>
    </div>
  </section>

  <main class="max-w-7xl mx-auto px-4 pb-16">
    <section id="productList" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6"></section>
  </main>

  <!-- Cart Drawer -->
  <aside id="cartDrawer" class="drawer fixed top-0 right-0 h-full w-full sm:w-[420px] bg-white dark:bg-[#0f1130] border-l border-indigo-100 dark:border-[#242659] p-5 z-50 flex flex-col" aria-hidden="true">
    <div class="flex items-center justify-between mb-3">
      <h3 class="font-bold text-lg" data-t="cart_title">Giỏ hàng</h3>
      <button id="closeCart" class="px-3 py-1 rounded border">✕</button>
    </div>
    <div id="cartItems" class="space-y-3 overflow-auto flex-1"></div>
    <div class="border-t mt-4 pt-3 flex justify-between items-center font-semibold text-lg">
      <span data-t="cart_total">Tổng:</span> <span id="subtotal">0 VND</span>
    </div>
    <button id="checkoutBtn" class="btn w-full mt-4" data-t="cart_checkout">Thanh toán</button>
  </aside>

  <!-- Checkout Modal -->
  <div id="checkoutModal" class="modal fixed inset-0 bg-black/50 backdrop-blur-sm items-center justify-center z-50">
    <div class="card max-w-md w-full space-y-3">
      <h3 class="font-semibold text-lg text-center" data-t="co_title">Xác nhận đơn hàng</h3>
      <div id="cartPreview" class="border p-3 text-sm rounded max-h-44 overflow-auto bg-gray-50 dark:bg-[#14163d]"></div>
      <input id="c-name" class="input" type="text" placeholder="Tên của bạn" required>
      <input id="c-email" class="input" type="email" placeholder="Email của bạn" required>
      <div id="vietqr" class="text-center"></div>
      <div class="flex gap-2">
        <button id="c-send" class="btn w-full" data-t="co_send">Gửi đơn</button>
        <button id="c-close" class="w-full border py-2 rounded hover:bg-gray-100 dark:hover:bg-[#1c1f4d]" data-t="co_close">Đóng</button>
      </div>
      <p id="c-msg" class="text-sm text-center"></p>
    </div>
  </div>

  <footer class="py-10 text-center text-sm text-gray-500 dark:text-indigo-300/60 border-t border-indigo-100 dark:border-[#242659]">
    © <span id="year"></span> Yuki Store — <span data-t="footer">Dịch vụ số chính chủ • Chuẩn từng bit.</span>
  </footer>

  <script>
  const EMAIL_PUBLIC_KEY="XyOU1Q5bhZffSPDHf",EMAIL_SERVICE_ID="service_yukistore1",TEMPLATE_TO_SHOP="template_apefcjr",TEMPLATE_TO_USER="template_bj571ct",SHOP_EMAIL="yukistore243@gmail.com";
  const BANK={bin:"970415",name:"Viettinbank",accountNo:"888844115555",accountName:"Nguyen Nhat Anh"};
  const QR_SIZE_PX=340;
// Danh sách sản phẩm (bao gồm gói 3 tháng cho ChatGPT Plus)
const PRODUCTS=[
  { name: "ChatGPT Plus", price: 139000, cat: "AI" },
  { name: "Discord Nitro (1m)", price: 99000, cat: "Discord" },
  { name: "YouTube Premium", price: 15000, cat: "YouTube" },
  // Gói 3 tháng ChatGPT Plus với giá ưu đãi
  { name: "ChatGPT Plus (3m)", price: 139000, cat: "AI" }
];
  const cart=[];const fmt=n=>(n||0).toLocaleString("vi-VN")+" VND";

  const renderProducts=()=>{const w=document.getElementById("productList");w.innerHTML="";PRODUCTS.forEach((p,i)=>{const d=document.createElement("div");d.className="card";d.innerHTML=`<h3 class='font-bold mb-2'>${p.name}</h3><p>${fmt(p.price)}</p><button class='btn w-full mt-3' onclick='addToCart(${i})'>Thêm vào giỏ</button>`;w.appendChild(d);});};
  const renderCart=()=>{const l=document.getElementById("cartItems");l.innerHTML="";let t=0;cart.forEach((x,i)=>{t+=x.price*x.qty;const r=document.createElement("div");r.className="flex justify-between border p-2 rounded";r.innerHTML=`<div>${x.name}<br><small>${fmt(x.price)} × ${x.qty}</small></div><button onclick='removeItem(${i})'>🗑</button>`;l.appendChild(r);});document.getElementById("subtotal").textContent=fmt(t);document.getElementById("cartCount").textContent="("+cart.reduce((s,x)=>s+x.qty,0)+")";};
  const addToCart=i=>{const p=PRODUCTS[i],f=cart.find(x=>x.name===p.name);f?f.qty++:cart.push({...p,qty:1});renderCart();openCart();};
  const removeItem=i=>{cart.splice(i,1);renderCart();};
  const openCart=()=>document.getElementById("cartDrawer").classList.add("open");
  const closeCart=()=>document.getElementById("cartDrawer").classList.remove("open");
  const genOrderId=()=>`YS-${Date.now().toString(36).toUpperCase()}`;
  const cartTotal=()=>cart.reduce((s,x)=>s+x.price*x.qty,0);
  const renderVietQR=(id,amt)=>{const u=`https://img.vietqr.io/image/${BANK.bin}-${BANK.accountNo}-compact.png?amount=${amt}&addInfo=${encodeURIComponent(id)}&accountName=${encodeURIComponent(BANK.accountName)}`;document.getElementById("vietqr").innerHTML=`<img src="${u}" width="${QR_SIZE_PX}" class="rounded border mt-3"><p class="text-xs mt-2 text-indigo-400">Nội dung: <b>${id}</b></p>`;return u;};
  const openCheckout=()=>{if(!cart.length){alert("Giỏ hàng trống.");return;}const p=document.getElementById("cartPreview");p.innerHTML=cart.map(x=>`• ${x.name} ×${x.qty} — ${fmt(x.price*x.qty)}`).join("<br>");document.getElementById("checkoutModal").classList.add("show");renderVietQR("PENDING",cartTotal());};
  const closeCheckout=()=>document.getElementById("checkoutModal").classList.remove("show");
  const initEmail=()=>emailjs.init({publicKey:EMAIL_PUBLIC_KEY});

  async function sendEmails({name,email}){
    const id=genOrderId(),total=cartTotal(),qr=renderVietQR(id,total),time_vi=new Date().toLocaleString("vi-VN");
    const toShop={to_email:SHOP_EMAIL,name,email,orderId:id,total:fmt(total),time:time_vi,bank_name:BANK.name,account_no:BANK.accountNo,account_name:BANK.accountName,transfer_note:id,qr_img_url:qr};
    const toUser={to_name:name,to_email:email,order_id:id,product_name:"Đơn hàng Yuki Store",product_plan:cart.map(x=>`• ${x.name} ×${x.qty}`).join("<br>"),product_price:fmt(total),bank_name:BANK.name,account_no:BANK.accountNo,account_name:BANK.accountName,transfer_note:id,time_vi,qr_img_url:qr};
    await Promise.all([
      emailjs.send(EMAIL_SERVICE_ID,TEMPLATE_TO_SHOP,toShop),
      emailjs.send(EMAIL_SERVICE_ID,TEMPLATE_TO_USER,toUser)
    ]);
    return id;
  }

  document.addEventListener("DOMContentLoaded",()=>{
    document.getElementById("year").textContent=new Date().getFullYear();
    renderProducts();initEmail();
    document.getElementById("openCart").onclick=openCart;
    document.getElementById("closeCart").onclick=closeCart;
    document.getElementById("checkoutBtn").onclick=openCheckout;
    document.getElementById("c-close").onclick=closeCheckout;

    document.getElementById("c-send").onclick=async()=>{
      const name=document.getElementById("c-name").value.trim();
      const email=document.getElementById("c-email").value.trim();
      const msg=document.getElementById("c-msg");
      if(!name||!email){msg.textContent="Nhập tên và email hợp lệ.";msg.className="text-red-500";return;}
      msg.textContent="Đang gửi...";msg.className="text-gray-500";
      try{const id=await sendEmails({name,email});msg.textContent="✅ Đơn đã gửi! Mã: "+id;msg.className="text-green-500";cart.length=0;renderCart();}
      catch(e){msg.textContent="❌ Lỗi gửi: "+(e.text||e.message);msg.className="text-red-500";}
    };
  });
  </script>
</body>
</html>
